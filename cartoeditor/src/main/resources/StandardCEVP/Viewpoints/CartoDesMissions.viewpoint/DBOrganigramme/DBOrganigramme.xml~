<?xml version="1.0" encoding="UTF-8"?>
<VirtualModel id="0" userID="FLX" useSpecificDescriptions="false" flexoID="-1" name="DBOrganigramme">
  <FlexoConcept id="1" userID="FLX" useSpecificDescriptions="false" flexoID="16" name="Pole">
    <Inspector id="2" flexoID="10" userID="FLX" useSpecificDescriptions="false" inspectorTitle="Pole" renderer="((instance.excelRow.excelCells.get(0).cellValue.toString + &quot; - &quot;) + instance.excelRow.excelCells.get(1).cellValue.toString)" />
    <ExcelRowRole id="3" cloningStratgey="Reference" flexoID="17" name="excelRow" useSpecificDescriptions="false" userID="FLX">
      <BasicExcelModelSlot idref="4" />
    </ExcelRowRole>
    <CreationScheme id="5" useSpecificDescriptions="false" width="800" userID="FLX" label="createFromExcelRow" definePopupDefaultSize="false" height="600" flexoID="19" skipConfirmationPanel="false" name="createFromExcelRow">
      <TechnologyObjectParameter id="6" useSpecificDescriptions="false" userID="FLX" label="excelRow" flexoID="21" isRequired="false" name="excelRow" />
      <DeclareFlexoRole id="7" userID="FLX" useSpecificDescriptions="false" object="parameters.excelRow" flexoID="22" assignation="excelRow" />
    </CreationScheme>
  </FlexoConcept>
  <FlexoConcept id="8" userID="FLX" useSpecificDescriptions="false" flexoID="18" name="Direction">
    <Inspector id="9" flexoID="13" userID="FLX" useSpecificDescriptions="false" inspectorTitle="Direction" renderer="((instance.excelRow.excelCells.get(1).cellValue.toString + &quot; - &quot;) + instance.excelRow.excelCells.get(2).cellValue.toString)" />
    <ExcelRowRole id="10" cloningStratgey="Reference" flexoID="29" name="excelRow" useSpecificDescriptions="false" userID="FLX">
      <BasicExcelModelSlot idref="4" />
    </ExcelRowRole>
    <FlexoConceptInstanceRole id="11" cloningStratgey="Reference" flexoID="47" name="poleDeRattachement" useSpecificDescriptions="false" userID="FLX" flexoConceptTypeURI="http://www.brest.fr/CartoDesMissions/DBOrganigramme#Pole">
      <VirtualModelModelSlot idref="12" />
    </FlexoConceptInstanceRole>
    <CreationScheme id="13" useSpecificDescriptions="false" width="800" userID="FLX" label="creationFromExcel" definePopupDefaultSize="false" height="600" flexoID="30" skipConfirmationPanel="false" name="creationFromExcel">
      <TechnologyObjectParameter id="14" useSpecificDescriptions="false" userID="FLX" label="excelRow" flexoID="32" isRequired="false" name="excelRow" />
      <DeclareFlexoRole id="15" userID="FLX" useSpecificDescriptions="false" object="parameters.excelRow" flexoID="33" assignation="excelRow" />
    </CreationScheme>
  </FlexoConcept>
  <Inspector id="16" flexoID="-1" userID="FLX" useSpecificDescriptions="false" inspectorTitle="DBOrganigramme" />
  <ExcelSheetRole id="17" cloningStratgey="Reference" flexoID="3" name="sheetPole" useSpecificDescriptions="false" userID="FLX">
    <BasicExcelModelSlot idref="4" />
  </ExcelSheetRole>
  <ExcelSheetRole id="18" cloningStratgey="Reference" flexoID="4" name="sheetDirection" useSpecificDescriptions="false" userID="FLX">
    <BasicExcelModelSlot idref="4" />
  </ExcelSheetRole>
  <ModelSlot_VirtualModelModelSlot id="12" cloningStratgey="Reference" flexoID="1" isRequired="false" userID="FLX" useSpecificDescriptions="false" name="virtualModelInstance" isReadOnly="false" virtualModelURI="http://www.brest.fr/CartoDesMissions/DBOrganigramme" />
  <ModelSlot_BasicExcelModelSlot id="4" cloningStratgey="Reference" flexoID="2" isRequired="true" name="excelData" useSpecificDescriptions="false" userID="FLX" isReadOnly="false" />
  <CreationScheme id="19" useSpecificDescriptions="false" width="800" userID="FLX" label="Création depuis un fichier Excel pris comme référence de l'organigramme de BMO" definePopupDefaultSize="false" height="600" flexoID="5" skipConfirmationPanel="false" name="creationDepuisExcel">
    <FetchRequestIterationAction id="20" flexoID="6" iteratorName="selectedSheet" useSpecificDescriptions="false" userID="FLX">
      <BasicExcelModelSlot idref="4" />
      <FetchRequest_SelectExcelSheet id="21" flexoID="7" userID="FLX" useSpecificDescriptions="false">
        <BasicExcelModelSlot idref="4" />
      </FetchRequest_SelectExcelSheet>
      <DeclareFlexoRole id="22" userID="FLX" useSpecificDescriptions="false" object="selectedSheet" flexoID="8" description="" assignation="sheetPole" conditional="(selectedSheet.name = &quot;Pôles&quot;)" />
      <DeclareFlexoRole id="23" userID="FLX" useSpecificDescriptions="false" object="selectedSheet" flexoID="9" description="" assignation="sheetDirection" conditional="(selectedSheet.name = &quot;Directions&quot;)" />
    </FetchRequestIterationAction>
  </CreationScheme>
  <SynchronizationScheme id="24" useSpecificDescriptions="false" width="800" userID="FLX" label="synchronizationDepuisExcel" definePopupDefaultSize="false" height="600" flexoID="34" skipConfirmationPanel="false" name="synchronizationDepuisExcel">
    <FetchRequestIterationAction id="25" flexoID="35" iteratorName="selectedRow" useSpecificDescriptions="false" userID="FLX">
      <BasicExcelModelSlot idref="4" />
      <FetchRequest_SelectExcelRow id="26" flexoID="36" excelSheet="sheetPole" userID="FLX" useSpecificDescriptions="false">
        <BasicExcelModelSlot idref="4" />
      </FetchRequest_SelectExcelRow>
      <MatchFlexoConceptInstance id="27" useSpecificDescriptions="false" userID="FLX" virtualModelInstance="virtualModelInstance" flexoID="39" creationSchemeURI="http://www.brest.fr/CartoDesMissions/DBOrganigramme#Pole.createFromExcelRow">
        <MatchingCriteria id="28" flexoID="77" useSpecificDescriptions="false" userID="FLX" value="selectedRow" patternRoleName="excelRow" />
        <CreateFlexoConceptInstanceParameter id="29" flexoID="78" useSpecificDescriptions="false" userID="FLX" value="selectedRow" paramName="excelRow" />
      </MatchFlexoConceptInstance>
    </FetchRequestIterationAction>
    <FetchRequestIterationAction id="30" flexoID="41" iteratorName="selectedRow" useSpecificDescriptions="false" userID="FLX">
      <BasicExcelModelSlot idref="4" />
      <FetchRequest_SelectExcelRow id="31" flexoID="42" excelSheet="sheetDirection" userID="FLX" useSpecificDescriptions="false">
        <BasicExcelModelSlot idref="4" />
      </FetchRequest_SelectExcelRow>
      <MatchFlexoConceptInstance id="32" useSpecificDescriptions="false" userID="FLX" virtualModelInstance="virtualModelInstance" flexoID="57" creationSchemeURI="http://www.brest.fr/CartoDesMissions/DBOrganigramme#Direction.creationFromExcel">
        <MatchingCriteria id="33" flexoID="79" useSpecificDescriptions="false" userID="FLX" value="selectedRow" patternRoleName="excelRow" />
        <MatchingCriteria id="34" flexoID="80" useSpecificDescriptions="false" userID="FLX" patternRoleName="poleDeRattachement" />
        <CreateFlexoConceptInstanceParameter id="35" flexoID="81" useSpecificDescriptions="false" userID="FLX" value="selectedRow" paramName="excelRow" />
      </MatchFlexoConceptInstance>
    </FetchRequestIterationAction>
    <ExecutionAction id="36" flexoID="70" description="" useSpecificDescriptions="false" userID="FLX" execution="virtualModelInstance.updateHierarchy()" />
  </SynchronizationScheme>
  <ActionScheme id="37" useSpecificDescriptions="false" width="800" userID="FLX" label="updateHierarchy" definePopupDefaultSize="false" height="600" flexoID="64" skipConfirmationPanel="false" name="updateHierarchy">
    <FetchRequestIterationAction id="38" flexoID="65" iteratorName="directionCI" useSpecificDescriptions="false" userID="FLX">
      <VirtualModelModelSlot idref="12" />
      <FetchRequest_SelectFlexoConceptInstance id="39" flexoID="66" userID="FLX" useSpecificDescriptions="false" flexoConceptTypeURI="http://www.brest.fr/CartoDesMissions/DBOrganigramme#Direction">
        <VirtualModelModelSlot idref="12" />
      </FetchRequest_SelectFlexoConceptInstance>
      <FetchRequestIterationAction id="40" flexoID="67" iteratorName="poleCI" description="" useSpecificDescriptions="false" userID="FLX">
        <VirtualModelModelSlot idref="12" />
        <FetchRequest_SelectFlexoConceptInstance id="41" flexoID="68" userID="FLX" useSpecificDescriptions="false" flexoConceptTypeURI="http://www.brest.fr/CartoDesMissions/DBOrganigramme#Pole">
          <Condition id="42" flexoID="-1" condition="(directionCI.excelRow.excelCells.get(0).cellValue.toString = selected.excelRow.excelCells.get(0).cellValue.toString)" userID="FLX" useSpecificDescriptions="false" />
          <VirtualModelModelSlot idref="12" />
        </FetchRequest_SelectFlexoConceptInstance>
        <DeclareFlexoRole id="43" userID="FLX" useSpecificDescriptions="false" object="poleCI" flexoID="69" description="" assignation="directionCI.poleDeRattachement" conditional="(poleCI != null)" />
      </FetchRequestIterationAction>
    </FetchRequestIterationAction>
  </ActionScheme>
</VirtualModel>
